<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="477px" preserveAspectRatio="none" style="width:875px;height:477px;" version="1.1" viewBox="0 0 875 477" width="875px" zoomAndPan="magnify"><defs/><g><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="43" x2="43" y1="34.2969" y2="420.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="307" x2="307" y1="34.2969" y2="420.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="582.5" x2="582.5" y1="34.2969" y2="420.2891"/><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="71" x="8" y="3"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="22.9951">Browser</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="71" x="8" y="419.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="439.2842">Browser</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="85" x="265" y="3"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="272" y="22.9951">client.com</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="85" x="265" y="419.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="272" y="439.2842">client.com</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="64" x="550.5" y="3"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="557.5" y="22.9951">as.com</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="64" x="550.5" y="419.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="557.5" y="439.2842">as.com</text><polygon fill="#375A7F" points="295.5,61.4297,305.5,65.4297,295.5,69.4297,299.5,65.4297" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="301.5" y1="65.4297" y2="65.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="50.5" y="60.3638">Use https://as.com</text><polygon fill="#375A7F" points="54.5,151.0938,44.5,155.0938,54.5,159.0938,50.5,155.0938" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="48.5" x2="306.5" y1="155.0938" y2="155.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="60.5" y="89.4966">Location: https://as.com/auth</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="92.5" y="104.6294">?redirect_uri=https://client.com/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="108.5" y="119.7622">&amp;client_id=client_at_as</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="108.5" y="134.895"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="108.5" y="134.895">&amp;code_challenge=sha256(</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="14" x="281.5" y="134.895">cv</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="295.5" y="134.895">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="108.5" y="150.0278">&amp;...</text><polygon fill="#375A7F" points="570.5,180.2266,580.5,184.2266,570.5,188.2266,574.5,184.2266" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="576.5" y1="184.2266" y2="184.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="50.5" y="179.1606">GET https://as.com/auth?...</text><polygon fill="#375A7F" points="54.5,209.3594,44.5,213.3594,54.5,217.3594,50.5,213.3594" style="stroke: #375A7F; stroke-width: 1.0;"/><polygon fill="#375A7F" points="570.5,209.3594,580.5,213.3594,570.5,217.3594,574.5,213.3594" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="48.5" x2="576.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="60.5" y="208.2935">user authentication, authorization</text><polygon fill="#375A7F" points="54.5,238.4922,44.5,242.4922,54.5,246.4922,50.5,242.4922" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="48.5" x2="581.5" y1="242.4922" y2="242.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="60.5" y="237.4263">Redirect to https://client.com/?code=</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="7" x="297.5" y="237.4263">c</text><polygon fill="#375A7F" points="295.5,267.625,305.5,271.625,295.5,275.625,299.5,271.625" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="301.5" y1="271.625" y2="271.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="50.5" y="266.5591">GET https://client.com/?code=</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="7" x="243.5" y="266.5591">c</text><polygon fill="#375A7F" points="570.5,311.8906,580.5,315.8906,570.5,319.8906,574.5,315.8906" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="307.5" x2="576.5" y1="315.8906" y2="315.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="314.5" y="295.6919">POST /token?code=</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="7" x="441.5" y="295.6919">c</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="448.5" y="295.6919">&amp;code_verifier=</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="14" x="551.5" y="295.6919">cv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="330.5" y="310.8247">&amp;redirect_uri=...</text><line style="stroke: #375A7F; stroke-width: 1.0;" x1="582.5" x2="624.5" y1="360.1563" y2="360.1563"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="624.5" x2="624.5" y1="360.1563" y2="373.1563"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="583.5" x2="624.5" y1="373.1563" y2="373.1563"/><polygon fill="#375A7F" points="593.5,369.1563,583.5,373.1563,593.5,377.1563,589.5,373.1563" style="stroke: #375A7F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="589.5" y="339.9575">Check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="589.5" y="355.0903">sha256(code_verifier) == code_challenge</text><polygon fill="#375A7F" points="318.5,398.2891,308.5,402.2891,318.5,406.2891,314.5,402.2891" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="312.5" x2="581.5" y1="402.2891" y2="402.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="324.5" y="397.2231">access token</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="61" x="802.5" y="463.8682">danielfett.de</text><!--MD5=[af3f1d8742c72a1d8e71831e6e395258]
@startuml
hide stereotype
skinparam shadowing false
skinparam sequence {
ArrowColor #375a7f
LifeLineBorderColor #aaa
BoundaryBackgroundColor #f00

ParticipantBorderColor #375a7f
ParticipantBackgroundColor #375a7f
ParticipantFontColor #fff
ParticipantFontName Roboto
ParticipantFontSize 14

BoxBackgroundColor #f0f0ff
BoxBorderColor transparent
ParticipantBackgroundColor<<Attacker>> #F08080
}

skinparam note {
BackgroundColor #CEE1F5
BorderColor #CEE1F5
FontColor #000

BackgroundColor<<warning>> #FFCEB5
BorderColor<<warning>> #FFCEB5

BackgroundColor<<ok>> #C6EAA6
BorderColor<<ok>> #C6EAA6
}

right footer danielfett.de
participant Browser
participant client.com
participant as.com

Browser -> client.com: Use https://as.com
client.com -> Browser: Location: https://as.com/auth\n        ?redirect_uri=https://client.com/\n            &client_id=client_at_as\n            <font color=blue>&code_challenge=sha256(<i>cv</i>)\n            &...

Browser -> as.com: GET https://as.com/auth?...
Browser <- -> as.com: user authentication, authorization
as.com -> Browser: Redirect to https://client.com/?code=<i>c</i>
Browser -> client.com: GET https://client.com/?code=<i>c</i>
client.com -> as.com: POST /token?code=<i>c</i><font color=blue>&code_verifier=<i>cv</i>\n    &redirect_uri=...
as.com -> as.com: Check \nsha256(code_verifier) == code_challenge
as.com -> client.com: access token
@enduml

PlantUML version 1.2020.08(Sun Apr 26 14:08:22 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>